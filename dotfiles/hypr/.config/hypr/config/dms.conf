# --- dms shell bindings ---

# Autostarts
exec-once = ~/.config/hypr/scripts/reload_config.sh
exec-once = dsearch serve

# Permissions
permission = /usr/bin/dms, screencopy, allow
permission = /usr/bin/quickshell, screencopy, allow

# Hard-override any earlier bindings for these combos
unbind = ALT, SPACE
unbind = $mainMod, COMMA
unbind = , XF86AudioRaiseVolume
unbind = , XF86AudioLowerVolume
unbind = , XF86AudioMute
unbind = , XF86AudioMicMute
unbind = , XF86MonBrightnessUp
unbind = , XF86MonBrightnessDown
unbind = $mainMod, N
unbind = $mainMod CTRL SHIFT, B
unbind = $mainMod ALT, W
unbind = $mainMod, A
unbind = $mainMod, V
unbind = $mainMod, ESCAPE
unbind = $mainMod, PERIOD
unbind = ALT, F4
# unbind = $mainMod, SLASH
unbind = , PRINT
unbind = SHIFT, PRINT
unbind = $mainMod SHIFT CTRL, P
unbind = CTRL ALT, DELETE
unbind = CTRL SHIFT, F5

# Spotlight
bind = ALT, SPACE, exec, dms ipc call spotlight toggle # [SHELL:dms] Toggle spotlight menu

# Shell settings
bind = $mainMod, COMMA, exec, dms ipc call settings toggle # [SHELL:dms] Toggle shell settings

# Audio (allow-when-locked=true -> use bindl)
# e at the end: allows the binding to repeat while you hold the key down
bindel = , XF86AudioRaiseVolume, exec, dms ipc call audio increment 5 # [SHELL:dms] Raise the volume
bindel = , XF86AudioLowerVolume, exec, dms ipc call audio decrement 5 # [SHELL:dms] Lower the volume
bindel = , XF86AudioMute, exec, dms ipc call audio mute # [SHELL:dms] Toggle mute audio
bindel = , XF86AudioMicMute, exec, dms ipc call audio micmute # [SHELL:dms] Toggle mute microphone

# Backlight (allow-when-locked=true -> use bindl)
# e at the end: allows the binding to repeat while you hold the key down
bindel = , XF86MonBrightnessUp, exec, dms ipc call brightness increment 5 backlight:intel_backlight # [SHELL:dms] Turn the brightness up
bindel = , XF86MonBrightnessDown, exec, dms ipc call brightness decrement 5 backlight:intel_backlight # [SHELL:dms] Turn the brightness down

# dms toggles
bind = $mainMod, N, exec, dms ipc call notifications toggle # [SHELL:dms] Toggle notifications panel
bind = $mainMod CTRL SHIFT, B, exec, dms ipc call dock toggleAutoHide # [SHELL:dms] Toggle dock auto-hide
bind = $mainMod ALT, W, exec, dms ipc call dash toggle wallpaper # [SHELL:dms] Toggle wallpaper dashboard
bind = $mainMod, A, exec, dms ipc call control-center toggle # [SHELL:dms] Toggle control center
bind = $mainMod, V, exec, dms ipc call clipboard toggle # [SHELL:dms] Toggle clipboard manager
bind = $mainMod, ESCAPE, exec, dms ipc call lock lock # [SHELL:dms] Lock the session
bind = $mainMod, PERIOD, exec, dms ipc call spotlight toggleQuery : # [SHELL:dms] Open spotlight emoji panel
bind = ALT, F4, exec, dms ipc call powermenu toggle # [SHELL:dms] Toggle power menu
# bind = $mainMod, SLASH, exec, dms ipc call keybinds toggle hyprland # [SHELL:dms] Toggle keybindings overlay

# Screenshot
bind = , PRINT, exec, dms screenshot # [SHELL:dms] Take area screenshot
bind = SHIFT, PRINT, exec, dms screenshot full # [SHELL:dms] Take full screen screenshot

# Color picker
bind = $mainMod SHIFT CTRL, P, exec, dms color pick -a # [SHELL:dms] Pick color from screen (auto copy)

# Task Manager
bind = CTRL ALT, DELETE, exec, dms ipc call processlist toggle # [SHELL:dms] Toggle task manager

# toggle_app.sh
bind = CTRL SHIFT, F5, exec, ~/.config/hypr/scripts/toggle_app.sh "dgop" "kitty --override confirm_os_window_close=0 --class dgop --title dgop dgop" # [SHELL:dms] Toggle dgop system monitor

# Windowrules for dgop
$dgop_class = ^(dgop)$
windowrule {
  name = dgop
  match:class = $dgop_class
  center = on
  float = on
  size = (monitor_w*0.8) (monitor_h*0.8)
}

# Windowrules for dms settings
windowrule {
  name = dms-settings
  match:class = org.quickshell
  match:title = Settings
  center = on
  float = on
  size = (monitor_w*0.6) (monitor_h*0.8)
}

# Layerrules
layerrule {
  name = dms
  match:namespace = dms:.*
  blur = on
  ignore_alpha = 0.2
}

layerrule {
  name = dms-exception
  match:namespace = dms:workspace-overview
  blur = off
  ignore_alpha = 0.0
}
